import{r as t,R as v}from"./index-0d5eMwbi.js";import{M as ce,W as D,y as Z,O as x,n as H,o as w,m as de,t as me,H as q,s as fe,p as ve,u as B}from"./use-sync-refs-Belg-Qp7.js";import{f as he}from"./use-is-mounted-DjLeIy05.js";import{l as ee,m as pe}from"./use-server-handoff-complete-CBlwwdlU.js";import{V as be,A as ge,i as S,c as Ee,u as ne}from"./open-closed-DLjF8coL.js";function re(e){var n;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||((n=e.as)!=null?n:le)!==t.Fragment||v.Children.count(e.children)===1}let N=t.createContext(null);N.displayName="TransitionContext";var Te=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Te||{});function $e(){let e=t.useContext(N);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function we(){let e=t.useContext(I);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let I=t.createContext(null);I.displayName="NestingContext";function U(e){return"children"in e?U(e.children):e.current.filter(({el:n})=>n.current!==null).filter(({state:n})=>n==="visible").length>0}function te(e,n){let l=fe(e),o=t.useRef([]),C=he(),P=ve(),d=w((a,r=x.Hidden)=>{let s=o.current.findIndex(({el:i})=>i===a);s!==-1&&(B(r,{[x.Unmount](){o.current.splice(s,1)},[x.Hidden](){o.current[s].state="hidden"}}),P.microTask(()=>{var i;!U(o)&&C.current&&((i=l.current)==null||i.call(l))}))}),R=w(a=>{let r=o.current.find(({el:s})=>s===a);return r?r.state!=="visible"&&(r.state="visible"):o.current.push({el:a,state:"visible"}),()=>d(a,x.Unmount)}),g=t.useRef([]),m=t.useRef(Promise.resolve()),h=t.useRef({enter:[],leave:[]}),p=w((a,r,s)=>{g.current.splice(0),n&&(n.chains.current[r]=n.chains.current[r].filter(([i])=>i!==a)),n==null||n.chains.current[r].push([a,new Promise(i=>{g.current.push(i)})]),n==null||n.chains.current[r].push([a,new Promise(i=>{Promise.all(h.current[r].map(([u,f])=>f)).then(()=>i())})]),r==="enter"?m.current=m.current.then(()=>n==null?void 0:n.wait.current).then(()=>s(r)):s(r)}),E=w((a,r,s)=>{Promise.all(h.current[r].splice(0).map(([i,u])=>u)).then(()=>{var i;(i=g.current.shift())==null||i()}).then(()=>s(r))});return t.useMemo(()=>({children:o,register:R,unregister:d,onStart:p,onStop:E,wait:m,chains:h}),[R,d,o,p,E,h,m])}let le=t.Fragment,ie=ce.RenderStrategy;function Ce(e,n){var l,o;let{transition:C=!0,beforeEnter:P,afterEnter:d,beforeLeave:R,afterLeave:g,enter:m,enterFrom:h,enterTo:p,entered:E,leave:a,leaveFrom:r,leaveTo:s,...i}=e,u=t.useRef(null),f=re(e),V=Z(...f?[u,n]:n===null?[]:[n]),T=(l=i.unmount)==null||l?x.Unmount:x.Hidden,{show:b,appear:G,initial:J}=$e(),[$,X]=t.useState(b?"visible":"hidden"),K=we(),{register:O,unregister:A}=K;H(()=>O(u),[O,u]),H(()=>{if(T===x.Hidden&&u.current){if(b&&$!=="visible"){X("visible");return}return B($,{hidden:()=>A(u),visible:()=>O(u)})}},[$,u,O,A,b,T]);let j=ee();H(()=>{if(f&&j&&$==="visible"&&u.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[u,$,j,f]);let ae=J&&!G,Q=G&&b&&J,_=t.useRef(!1),L=te(()=>{_.current||(X("hidden"),A(u))},K),W=w(k=>{_.current=!0;let M=k?"enter":"leave";L.onStart(u,M,y=>{y==="enter"?P==null||P():y==="leave"&&(R==null||R())})}),Y=w(k=>{let M=k?"enter":"leave";_.current=!1,L.onStop(u,M,y=>{y==="enter"?d==null||d():y==="leave"&&(g==null||g())}),M==="leave"&&!U(L)&&(X("hidden"),A(u))});t.useEffect(()=>{f&&C||(W(b),Y(b))},[b,f,C]);let se=!(!C||!f||!j||ae),[,c]=be(se,u,b,{start:W,end:Y}),oe=de({ref:V,className:((o=me(i.className,Q&&m,Q&&h,c.enter&&m,c.enter&&c.closed&&h,c.enter&&!c.closed&&p,c.leave&&a,c.leave&&!c.closed&&r,c.leave&&c.closed&&s,!c.transition&&b&&E))==null?void 0:o.trim())||void 0,...ge(c)}),F=0;return $==="visible"&&(F|=S.Open),$==="hidden"&&(F|=S.Closed),c.enter&&(F|=S.Opening),c.leave&&(F|=S.Closing),v.createElement(I.Provider,{value:L},v.createElement(Ee,{value:F},q({ourProps:oe,theirProps:i,defaultTag:le,features:ie,visible:$==="visible",name:"Transition.Child"})))}function Re(e,n){let{show:l,appear:o=!1,unmount:C=!0,...P}=e,d=t.useRef(null),R=re(e),g=Z(...R?[d,n]:n===null?[]:[n]);ee();let m=ne();if(l===void 0&&m!==null&&(l=(m&S.Open)===S.Open),l===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,p]=t.useState(l?"visible":"hidden"),E=te(()=>{l||p("hidden")}),[a,r]=t.useState(!0),s=t.useRef([l]);H(()=>{a!==!1&&s.current[s.current.length-1]!==l&&(s.current.push(l),r(!1))},[s,l]);let i=t.useMemo(()=>({show:l,appear:o,initial:a}),[l,o,a]);pe(l,d,()=>p("hidden")),H(()=>{l?p("visible"):!U(E)&&d.current!==null&&p("hidden")},[l,E]);let u={unmount:C},f=w(()=>{var T;a&&r(!1),(T=e.beforeEnter)==null||T.call(e)}),V=w(()=>{var T;a&&r(!1),(T=e.beforeLeave)==null||T.call(e)});return v.createElement(I.Provider,{value:E},v.createElement(N.Provider,{value:i},q({ourProps:{...u,as:t.Fragment,children:v.createElement(ue,{ref:g,...u,...P,beforeEnter:f,beforeLeave:V})},theirProps:{},defaultTag:t.Fragment,features:ie,visible:h==="visible",name:"Transition"})))}function xe(e,n){let l=t.useContext(N)!==null,o=ne()!==null;return v.createElement(v.Fragment,null,!l&&o?v.createElement(z,{ref:n,...e}):v.createElement(ue,{ref:n,...e}))}let z=D(Re),ue=D(Ce),Pe=D(xe),Ae=Object.assign(z,{Child:Pe,Root:z});export{Pe as I,Ae as X};
