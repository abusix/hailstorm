import{r as s,R as g}from"./index-DRjF_FHU.js";import{n as v,s as E,a as y,o as b,c as W,K as x,y as L,L as R,T as k,b as $}from"./use-sync-refs-4PSbzubZ.js";import{A as I,h as N}from"./focus-management-CtIqEZ7d.js";import{r as B}from"./index-C-39nNrC.js";import{o as V}from"./keyboard-BXsyG9-6.js";import{l as Y}from"./use-server-handoff-complete-D6bOsrEP.js";let U=class extends Map{constructor(t){super(),this.factory=t}get(t){let n=super.get(t);return n===void 0&&(n=this.factory(t),this.set(t,n)),n}};function M(e,t){let n=e(),r=new Set;return{getSnapshot(){return n},subscribe(u){return r.add(u),()=>r.delete(u)},dispatch(u,...o){let i=t[u].call(n,...o);i&&(n=i,r.forEach(a=>a()))}}}function C(e){return s.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}let _=new U(()=>M(()=>[],{ADD(e){return this.includes(e)?this:[...this,e]},REMOVE(e){let t=this.indexOf(e);if(t===-1)return this;let n=this.slice();return n.splice(t,1),n}}));function S(e,t){let n=_.get(t),r=s.useId(),u=C(n);if(v(()=>{if(e)return n.dispatch("ADD",r),()=>n.dispatch("REMOVE",r)},[n,e]),!e)return!1;let o=u.indexOf(r),i=u.length;return o===-1&&(o=i,i+=1),o===i-1}function pe(e,t,n){let r=E(u=>{let o=u.getBoundingClientRect();o.x===0&&o.y===0&&o.width===0&&o.height===0&&n()});s.useEffect(()=>{if(!e)return;let u=t===null?null:t instanceof HTMLElement?t:t.current;if(!u)return;let o=y();if(typeof ResizeObserver<"u"){let i=new ResizeObserver(()=>r.current(u));i.observe(u),o.add(()=>i.disconnect())}if(typeof IntersectionObserver<"u"){let i=new IntersectionObserver(()=>r.current(u));i.observe(u),o.add(()=>i.disconnect())}return()=>o.dispose()},[t,r,e])}function T(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function j(){return/Android/gi.test(window.navigator.userAgent)}function F(){return T()||j()}function p(e,t,n,r){let u=E(n);s.useEffect(()=>{if(!e)return;function o(i){u.current(i)}return document.addEventListener(t,o,r),()=>document.removeEventListener(t,o,r)},[e,t,r])}function X(e,t,n,r){let u=E(n);s.useEffect(()=>{if(!e)return;function o(i){u.current(i)}return window.addEventListener(t,o,r),()=>window.removeEventListener(t,o,r)},[e,t,r])}const O=30;function ve(e,t,n){let r=S(e,"outside-click"),u=E(n),o=s.useCallback(function(l,c){if(l.defaultPrevented)return;let d=c(l);if(d===null||!d.getRootNode().contains(d)||!d.isConnected)return;let w=(function h(f){return typeof f=="function"?h(f()):Array.isArray(f)||f instanceof Set?f:[f]})(t);for(let h of w)if(h!==null&&(h.contains(d)||l.composed&&l.composedPath().includes(h)))return;return!I(d,N.Loose)&&d.tabIndex!==-1&&l.preventDefault(),u.current(l,d)},[u,t]),i=s.useRef(null);p(r,"pointerdown",l=>{var c,d;i.current=((d=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:d[0])||l.target},!0),p(r,"mousedown",l=>{var c,d;i.current=((d=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:d[0])||l.target},!0),p(r,"click",l=>{F()||i.current&&(o(l,()=>i.current),i.current=null)},!0);let a=s.useRef({x:0,y:0});p(r,"touchstart",l=>{a.current.x=l.touches[0].clientX,a.current.y=l.touches[0].clientY},!0),p(r,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-a.current.x)>=O||Math.abs(c.y-a.current.y)>=O))return o(l,()=>l.target instanceof HTMLElement?l.target:null)},!0),X(r,"blur",l=>o(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function z(...e){return s.useMemo(()=>V(...e),[...e])}function G(){let e;return{before({doc:t}){var n;let r=t.documentElement,u=(n=t.defaultView)!=null?n:window;e=Math.max(0,u.innerWidth-r.clientWidth)},after({doc:t,d:n}){let r=t.documentElement,u=Math.max(0,r.clientWidth-r.offsetWidth),o=Math.max(0,e-u);n.style(r,"paddingRight",`${o}px`)}}}function q(){return T()?{before({doc:e,d:t,meta:n}){function r(u){return n.containers.flatMap(o=>o()).some(o=>o.contains(u))}t.microTask(()=>{var u;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let a=y();a.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>a.dispose()))}let o=(u=window.scrollY)!=null?u:window.pageYOffset,i=null;t.addEventListener(e,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),d=e.querySelector(c);d&&!r(d)&&(i=d)}catch{}},!0),t.addEventListener(e,"touchstart",a=>{if(a.target instanceof HTMLElement)if(r(a.target)){let l=a.target;for(;l.parentElement&&r(l.parentElement);)l=l.parentElement;t.style(l,"overscrollBehavior","contain")}else t.style(a.target,"touchAction","none")}),t.addEventListener(e,"touchmove",a=>{if(a.target instanceof HTMLElement){if(a.target.tagName==="INPUT")return;if(r(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()}},{passive:!1}),t.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;o!==l&&window.scrollTo(0,o),i&&i.isConnected&&(i.scrollIntoView({block:"nearest"}),i=null)})})}}:{}}function J(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function K(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let m=M(()=>new Map,{PUSH(e,t){var n;let r=(n=this.get(e))!=null?n:{doc:e,count:0,d:y(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:n}){let r={doc:e,d:t,meta:K(n)},u=[q(),G(),J()];u.forEach(({before:o})=>o==null?void 0:o(r)),u.forEach(({after:o})=>o==null?void 0:o(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});m.subscribe(()=>{let e=m.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let r=t.get(n.doc)==="hidden",u=n.count!==0;(u&&!r||!u&&r)&&m.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&m.dispatch("TEARDOWN",n)}});function Q(e,t,n=()=>({containers:[]})){let r=C(m),u=t?r.get(t):void 0,o=u?u.count>0:!1;return v(()=>{if(!(!t||!e))return m.dispatch("PUSH",t,n),()=>m.dispatch("POP",t,n)},[e,t]),o}function ge(e,t,n=()=>[document.body]){let r=S(e,"scroll-lock");Q(r,t,u=>{var o;return{containers:[...(o=u.containers)!=null?o:[],n]}})}function Z(e){let t=b(e),n=s.useRef(!1);s.useEffect(()=>(n.current=!1,()=>{n.current=!0,W(()=>{n.current&&t()})}),[t])}let A=s.createContext(!1);function ee(){return s.useContext(A)}function Ee(e){return g.createElement(A.Provider,{value:e.force},e.children)}function te(e){let t=ee(),n=s.useContext(H),[r,u]=s.useState(()=>{var o;if(!t&&n!==null)return(o=n.current)!=null?o:null;if($.isServer)return null;let i=e==null?void 0:e.getElementById("headlessui-portal-root");if(i)return i;if(e===null)return null;let a=e.createElement("div");return a.setAttribute("id","headlessui-portal-root"),e.body.appendChild(a)});return s.useEffect(()=>{r!==null&&(e!=null&&e.body.contains(r)||e==null||e.body.appendChild(r))},[r,e]),s.useEffect(()=>{t||n!==null&&u(n.current)},[n,u,t]),r}let D=s.Fragment,ne=x(function(e,t){let{ownerDocument:n=null,...r}=e,u=s.useRef(null),o=L(k(f=>{u.current=f}),t),i=z(u),a=n??i,l=te(a),[c]=s.useState(()=>{var f;return $.isServer?null:(f=a==null?void 0:a.createElement("div"))!=null?f:null}),d=s.useContext(P),w=Y();v(()=>{!l||!c||l.contains(c)||(c.setAttribute("data-headlessui-portal",""),l.appendChild(c))},[l,c]),v(()=>{if(c&&d)return d.register(c)},[d,c]),Z(()=>{var f;!l||!c||(c instanceof Node&&l.contains(c)&&l.removeChild(c),l.childNodes.length<=0&&((f=l.parentElement)==null||f.removeChild(l)))});let h=R();return w?!l||!c?null:B.createPortal(h({ourProps:{ref:o},theirProps:r,slot:{},defaultTag:D,name:"Portal"}),c):null});function re(e,t){let n=L(t),{enabled:r=!0,ownerDocument:u,...o}=e,i=R();return r?g.createElement(ne,{...o,ownerDocument:u,ref:n}):i({ourProps:{ref:n},theirProps:o,slot:{},defaultTag:D,name:"Portal"})}let oe=s.Fragment,H=s.createContext(null);function le(e,t){let{target:n,...r}=e,u={ref:L(t)},o=R();return g.createElement(H.Provider,{value:n},o({ourProps:u,theirProps:r,defaultTag:oe,name:"Popover.Group"}))}let P=s.createContext(null);function we(){let e=s.useContext(P),t=s.useRef([]),n=b(o=>(t.current.push(o),e&&e.register(o),()=>r(o))),r=b(o=>{let i=t.current.indexOf(o);i!==-1&&t.current.splice(i,1),e&&e.unregister(o)}),u=s.useMemo(()=>({register:n,unregister:r,portals:t}),[n,r,t]);return[t,s.useMemo(()=>function({children:o}){return g.createElement(P.Provider,{value:u},o)},[u])]}let ue=x(re),ie=x(le),be=Object.assign(ue,{Group:ie});export{ie as D,ve as R,Ee as a,U as b,Z as c,F as d,ge as f,we as l,pe as m,z as n,be as o,X as s,S as x};
