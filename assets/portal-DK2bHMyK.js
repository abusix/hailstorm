import{r as s,R as g}from"./index-DX35FyXq.js";import{A as N,h as k}from"./focus-management-2QVwgUsp.js";import{n as v,s as P,a as $,o as E,c as I,W as y,y as b,T as V,b as M,H as x}from"./use-sync-refs-DTQ85WuU.js";import{r as Y}from"./index-CrrVXmAv.js";import{u as B}from"./keyboard-CMPngVPH.js";import{l as F}from"./use-server-handoff-complete-czgFdGyU.js";let U=class extends Map{constructor(e){super(),this.factory=e}get(e){let n=super.get(e);return n===void 0&&(n=this.factory(e),this.set(e,n)),n}};function S(t,e){let n=t(),r=new Set;return{getSnapshot(){return n},subscribe(l){return r.add(l),()=>r.delete(l)},dispatch(l,...u){let a=e[l].call(n,...u);a&&(n=a,r.forEach(i=>i()))}}}function T(t){return s.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}let _=new U(()=>S(()=>[],{ADD(t){return this.includes(t)?this:[...this,t]},REMOVE(t){let e=this.indexOf(t);if(e===-1)return this;let n=this.slice();return n.splice(e,1),n}}));function C(t,e){let n=_.get(e),r=s.useId(),l=T(n);if(v(()=>{if(t)return n.dispatch("ADD",r),()=>n.dispatch("REMOVE",r)},[n,t]),!t)return!1;let u=l.indexOf(r),a=l.length;return u===-1&&(u=a,a+=1),u===a-1}function R(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function j(){return/Android/gi.test(window.navigator.userAgent)}function G(){return R()||j()}function p(t,e,n,r){let l=P(n);s.useEffect(()=>{if(!t)return;function u(a){l.current(a)}return document.addEventListener(e,u,r),()=>document.removeEventListener(e,u,r)},[t,e,r])}function X(t,e,n,r){let l=P(n);s.useEffect(()=>{if(!t)return;function u(a){l.current(a)}return window.addEventListener(e,u,r),()=>window.removeEventListener(e,u,r)},[t,e,r])}const L=30;function pe(t,e,n){let r=C(t,"outside-click"),l=P(n),u=s.useCallback(function(o,d){if(o.defaultPrevented)return;let c=d(o);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let H=function m(f){return typeof f=="function"?m(f()):Array.isArray(f)||f instanceof Set?f:[f]}(e);for(let m of H){if(m===null)continue;let f=m instanceof HTMLElement?m:m.current;if(f!=null&&f.contains(c)||o.composed&&o.composedPath().includes(f))return}return!N(c,k.Loose)&&c.tabIndex!==-1&&o.preventDefault(),l.current(o,c)},[l]),a=s.useRef(null);p(r,"pointerdown",o=>{var d,c;a.current=((c=(d=o.composedPath)==null?void 0:d.call(o))==null?void 0:c[0])||o.target},!0),p(r,"mousedown",o=>{var d,c;a.current=((c=(d=o.composedPath)==null?void 0:d.call(o))==null?void 0:c[0])||o.target},!0),p(r,"click",o=>{G()||a.current&&(u(o,()=>a.current),a.current=null)},!0);let i=s.useRef({x:0,y:0});p(r,"touchstart",o=>{i.current.x=o.touches[0].clientX,i.current.y=o.touches[0].clientY},!0),p(r,"touchend",o=>{let d={x:o.changedTouches[0].clientX,y:o.changedTouches[0].clientY};if(!(Math.abs(d.x-i.current.x)>=L||Math.abs(d.y-i.current.y)>=L))return u(o,()=>o.target instanceof HTMLElement?o.target:null)},!0),X(r,"blur",o=>u(o,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function O(...t){return s.useMemo(()=>B(...t),[...t])}function q(){let t;return{before({doc:e}){var n;let r=e.documentElement,l=(n=e.defaultView)!=null?n:window;t=Math.max(0,l.innerWidth-r.clientWidth)},after({doc:e,d:n}){let r=e.documentElement,l=Math.max(0,r.clientWidth-r.offsetWidth),u=Math.max(0,t-l);n.style(r,"paddingRight",`${u}px`)}}}function J(){return R()?{before({doc:t,d:e,meta:n}){function r(l){return n.containers.flatMap(u=>u()).some(u=>u.contains(l))}e.microTask(()=>{var l;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let i=$();i.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>i.dispose()))}let u=(l=window.scrollY)!=null?l:window.pageYOffset,a=null;e.addEventListener(t,"click",i=>{if(i.target instanceof HTMLElement)try{let o=i.target.closest("a");if(!o)return;let{hash:d}=new URL(o.href),c=t.querySelector(d);c&&!r(c)&&(a=c)}catch{}},!0),e.addEventListener(t,"touchstart",i=>{if(i.target instanceof HTMLElement)if(r(i.target)){let o=i.target;for(;o.parentElement&&r(o.parentElement);)o=o.parentElement;e.style(o,"overscrollBehavior","contain")}else e.style(i.target,"touchAction","none")}),e.addEventListener(t,"touchmove",i=>{if(i.target instanceof HTMLElement){if(i.target.tagName==="INPUT")return;if(r(i.target)){let o=i.target;for(;o.parentElement&&o.dataset.headlessuiPortal!==""&&!(o.scrollHeight>o.clientHeight||o.scrollWidth>o.clientWidth);)o=o.parentElement;o.dataset.headlessuiPortal===""&&i.preventDefault()}else i.preventDefault()}},{passive:!1}),e.add(()=>{var i;let o=(i=window.scrollY)!=null?i:window.pageYOffset;u!==o&&window.scrollTo(0,u),a&&a.isConnected&&(a.scrollIntoView({block:"nearest"}),a=null)})})}}:{}}function z(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function K(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let h=S(()=>new Map,{PUSH(t,e){var n;let r=(n=this.get(t))!=null?n:{doc:t,count:0,d:$(),meta:new Set};return r.count++,r.meta.add(e),this.set(t,r),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:n}){let r={doc:t,d:e,meta:K(n)},l=[J(),q(),z()];l.forEach(({before:u})=>u==null?void 0:u(r)),l.forEach(({after:u})=>u==null?void 0:u(r))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});h.subscribe(()=>{let t=h.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let r=e.get(n.doc)==="hidden",l=n.count!==0;(l&&!r||!l&&r)&&h.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&h.dispatch("TEARDOWN",n)}});function Q(t,e,n=()=>({containers:[]})){let r=T(h),l=e?r.get(e):void 0,u=l?l.count>0:!1;return v(()=>{if(!(!e||!t))return h.dispatch("PUSH",e,n),()=>h.dispatch("POP",e,n)},[t,e]),u}function ve(t,e,n=()=>[document.body]){let r=C(t,"scroll-lock");Q(r,e,l=>{var u;return{containers:[...(u=l.containers)!=null?u:[],n]}})}function Z(t){let e=E(t),n=s.useRef(!1);s.useEffect(()=>(n.current=!1,()=>{n.current=!0,I(()=>{n.current&&e()})}),[e])}let A=s.createContext(!1);function ee(){return s.useContext(A)}function ge(t){return g.createElement(A.Provider,{value:t.force},t.children)}function te(t){let e=ee(),n=s.useContext(D),r=O(t),[l,u]=s.useState(()=>{var a;if(!e&&n!==null)return(a=n.current)!=null?a:null;if(M.isServer)return null;let i=r==null?void 0:r.getElementById("headlessui-portal-root");if(i)return i;if(r===null)return null;let o=r.createElement("div");return o.setAttribute("id","headlessui-portal-root"),r.body.appendChild(o)});return s.useEffect(()=>{l!==null&&(r!=null&&r.body.contains(l)||r==null||r.body.appendChild(l))},[l,r]),s.useEffect(()=>{e||n!==null&&u(n.current)},[n,u,e]),l}let W=s.Fragment,ne=y(function(t,e){let n=t,r=s.useRef(null),l=b(V(c=>{r.current=c}),e),u=O(r),a=te(r),[i]=s.useState(()=>{var c;return M.isServer?null:(c=u==null?void 0:u.createElement("div"))!=null?c:null}),o=s.useContext(w),d=F();return v(()=>{!a||!i||a.contains(i)||(i.setAttribute("data-headlessui-portal",""),a.appendChild(i))},[a,i]),v(()=>{if(i&&o)return o.register(i)},[o,i]),Z(()=>{var c;!a||!i||(i instanceof Node&&a.contains(i)&&a.removeChild(i),a.childNodes.length<=0&&((c=a.parentElement)==null||c.removeChild(a)))}),d?!a||!i?null:Y.createPortal(x({ourProps:{ref:l},theirProps:n,slot:{},defaultTag:W,name:"Portal"}),i):null});function re(t,e){let n=b(e),{enabled:r=!0,...l}=t;return r?g.createElement(ne,{...l,ref:n}):x({ourProps:{ref:n},theirProps:l,slot:{},defaultTag:W,name:"Portal"})}let oe=s.Fragment,D=s.createContext(null);function le(t,e){let{target:n,...r}=t,l={ref:b(e)};return g.createElement(D.Provider,{value:n},x({ourProps:l,theirProps:r,defaultTag:oe,name:"Popover.Group"}))}let w=s.createContext(null);function Ee(){let t=s.useContext(w),e=s.useRef([]),n=E(u=>(e.current.push(u),t&&t.register(u),()=>r(u))),r=E(u=>{let a=e.current.indexOf(u);a!==-1&&e.current.splice(a,1),t&&t.unregister(u)}),l=s.useMemo(()=>({register:n,unregister:r,portals:e}),[n,r,e]);return[e,s.useMemo(()=>function({children:u}){return g.createElement(w.Provider,{value:l},u)},[l])]}let ue=y(re),ie=y(le),we=Object.assign(ue,{Group:ie});export{pe as F,ie as J,G as a,Z as c,Ee as e,ve as f,ge as l,O as n,X as s,we as t,C as x};
