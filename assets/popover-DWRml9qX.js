import{$ as Ie,a as xe,w as Ce,e as we}from"./use-resolve-button-type-HzzQKYtS.js";import{r,R as v}from"./index-0d5eMwbi.js";import{M as Fe,y as Te,x as ke,R as Be,b as Re,d as Me}from"./floating-Bhi-vCn9.js";import{O as te,K as z,y as j,T as Oe,s as me,o as E,L as ee,u as J,_ as le,n as _e}from"./use-sync-refs-DhZgiOVe.js";import{E as De}from"./use-event-listener-EaZKqAMH.js";import{n as ie,t as Ne,R as Le,m as Ae,f as Ke,r as Ge}from"./portal-BQQr4JoD.js";import{b as He,R as Ue,O as be,u as Pe,a as L}from"./use-tab-direction-CvE89ORz.js";import{c as Je,i as q,u as Se,x as Ee,R as ye,s as Qe}from"./open-closed-FM4Rfwkx.js";import{C as Ye}from"./close-provider-CZp7Lqob.js";import{f as ue,s as ae}from"./hidden-DfUyyskI.js";import{r as $e}from"./bugs-DpEN4NTH.js";import{b as ce,P as U,F as A,A as Ze,h as Ve,T as se}from"./focus-management-CKkqTXfi.js";import{o as H,u as We}from"./keyboard-D0BTZntQ.js";var je=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(je||{}),qe=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(qe||{});let ze={0:e=>({...e,popoverState:J(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,u){return e.button===u.button?e:{...e,button:u.button}},3(e,u){return e.buttonId===u.buttonId?e:{...e,buttonId:u.buttonId}},4(e,u){return e.panel===u.panel?e:{...e,panel:u.panel}},5(e,u){return e.panelId===u.panelId?e:{...e,panelId:u.panelId}}},pe=r.createContext(null);pe.displayName="PopoverContext";function ne(e){let u=r.useContext(pe);if(u===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,ne),p}return u}let re=r.createContext(null);re.displayName="PopoverAPIContext";function de(e){let u=r.useContext(re);if(u===null){let p=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,de),p}return u}let fe=r.createContext(null);fe.displayName="PopoverGroupContext";function ge(){return r.useContext(fe)}let oe=r.createContext(null);oe.displayName="PopoverPanelContext";function Xe(){return r.useContext(oe)}function et(e,u){return J(u.type,ze,e,u)}let tt="div";function nt(e,u){var p;let{__demoMode:x=!1,...m}=e,g=r.useRef(null),C=j(u,Oe(a=>{g.current=a})),o=r.useRef([]),f=r.useReducer(et,{__demoMode:x,popoverState:x?0:1,buttons:o,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:r.createRef(),afterPanelSentinel:r.createRef(),afterButtonSentinel:r.createRef()}),[{popoverState:h,button:n,buttonId:b,panel:d,panelId:y,beforePanelSentinel:$,afterPanelSentinel:P,afterButtonSentinel:l},c]=f,S=ie((p=g.current)!=null?p:n),B=r.useMemo(()=>{if(!n||!d)return!1;for(let I of document.querySelectorAll("body > *"))if(Number(I==null?void 0:I.contains(n))^Number(I==null?void 0:I.contains(d)))return!0;let a=ce(),t=a.indexOf(n),i=(t+a.length-1)%a.length,s=(t+1)%a.length,F=a[i],k=a[s];return!d.contains(F)&&!d.contains(k)},[n,d]),R=me(b),M=me(y),Q=r.useMemo(()=>({buttonId:R,panelId:M,close:()=>c({type:1})}),[R,M,c]),O=ge(),w=O==null?void 0:O.registerPopover,K=E(()=>{var a;return(a=O==null?void 0:O.isFocusWithinPopoverGroup())!=null?a:(S==null?void 0:S.activeElement)&&((n==null?void 0:n.contains(S.activeElement))||(d==null?void 0:d.contains(S.activeElement)))});r.useEffect(()=>w==null?void 0:w(Q),[w,Q]);let[T,Y]=Ne(),G=He(n),_=Ue({mainTreeNode:G,portals:T,defaultContainers:[n,d]});De(S==null?void 0:S.defaultView,"focus",a=>{var t,i,s,F,k,I;a.target!==window&&a.target instanceof HTMLElement&&h===0&&(K()||n&&d&&(_.contains(a.target)||(i=(t=$.current)==null?void 0:t.contains)!=null&&i.call(t,a.target)||(F=(s=P.current)==null?void 0:s.contains)!=null&&F.call(s,a.target)||(I=(k=l.current)==null?void 0:k.contains)!=null&&I.call(k,a.target)||c({type:1})))},!0),Le(h===0,_.resolveContainers,(a,t)=>{c({type:1}),Ze(t,Ve.Loose)||(a.preventDefault(),n==null||n.focus())});let D=E(a=>{c({type:1});let t=a?a instanceof HTMLElement?a:"current"in a&&a.current instanceof HTMLElement?a.current:n:n;t==null||t.focus()}),Z=r.useMemo(()=>({close:D,isPortalled:B}),[D,B]),V=r.useMemo(()=>({open:h===0,close:D}),[h,D]),W={ref:C},X=ee();return v.createElement(be,{node:G},v.createElement(Fe,null,v.createElement(oe.Provider,{value:null},v.createElement(pe.Provider,{value:f},v.createElement(re.Provider,{value:Z},v.createElement(Ye,{value:D},v.createElement(Je,{value:J(h,{0:q.Open,1:q.Closed})},v.createElement(Y,null,X({ourProps:W,theirProps:m,slot:V,defaultTag:tt,name:"Popover"})))))))))}let rt="button";function ot(e,u){let p=r.useId(),{id:x=`headlessui-popover-button-${p}`,disabled:m=!1,autoFocus:g=!1,...C}=e,[o,f]=ne("Popover.Button"),{isPortalled:h}=de("Popover.Button"),n=r.useRef(null),b=`headlessui-focus-sentinel-${r.useId()}`,d=ge(),y=d==null?void 0:d.closeOthers,$=Xe()!==null;r.useEffect(()=>{if(!$)return f({type:3,buttonId:x}),()=>{f({type:3,buttonId:null})}},[$,x,f]);let[P]=r.useState(()=>Symbol()),l=j(n,u,Te(),E(t=>{if(!$){if(t)o.buttons.current.push(P);else{let i=o.buttons.current.indexOf(P);i!==-1&&o.buttons.current.splice(i,1)}o.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),t&&f({type:2,button:t})}})),c=j(n,u),S=ie(n),B=E(t=>{var i,s,F;if($){if(o.popoverState===1)return;switch(t.key){case H.Space:case H.Enter:t.preventDefault(),(s=(i=t.target).click)==null||s.call(i),f({type:1}),(F=o.button)==null||F.focus();break}}else switch(t.key){case H.Space:case H.Enter:t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(y==null||y(o.buttonId)),f({type:0});break;case H.Escape:if(o.popoverState!==0)return y==null?void 0:y(o.buttonId);if(!n.current||S!=null&&S.activeElement&&!n.current.contains(S.activeElement))return;t.preventDefault(),t.stopPropagation(),f({type:1});break}}),R=E(t=>{$||t.key===H.Space&&t.preventDefault()}),M=E(t=>{var i,s;$e(t.currentTarget)||m||($?(f({type:1}),(i=o.button)==null||i.focus()):(t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(y==null||y(o.buttonId)),f({type:0}),(s=o.button)==null||s.focus()))}),Q=E(t=>{t.preventDefault(),t.stopPropagation()}),{isFocusVisible:O,focusProps:w}=Ie({autoFocus:g}),{isHovered:K,hoverProps:T}=xe({isDisabled:m}),{pressed:Y,pressProps:G}=Ce({disabled:m}),_=o.popoverState===0,D=r.useMemo(()=>({open:_,active:Y||_,disabled:m,hover:K,focus:O,autofocus:g}),[_,K,O,Y,m,g]),Z=we(e,o.button),V=$?le({ref:c,type:Z,onKeyDown:B,onClick:M,disabled:m||void 0,autoFocus:g},w,T,G):le({ref:l,id:o.buttonId,type:Z,"aria-expanded":o.popoverState===0,"aria-controls":o.panel?o.panelId:void 0,disabled:m||void 0,autoFocus:g,onKeyDown:B,onKeyUp:R,onClick:M,onMouseDown:Q},w,T,G),W=Pe(),X=E(()=>{let t=o.panel;if(!t)return;function i(){J(W.current,{[L.Forwards]:()=>U(t,A.First),[L.Backwards]:()=>U(t,A.Last)})===se.Error&&U(ce().filter(s=>s.dataset.headlessuiFocusGuard!=="true"),J(W.current,{[L.Forwards]:A.Next,[L.Backwards]:A.Previous}),{relativeTo:o.button})}i()}),a=ee();return v.createElement(v.Fragment,null,a({ourProps:V,theirProps:C,slot:D,defaultTag:rt,name:"Popover.Button"}),_&&!$&&h&&v.createElement(ue,{id:b,ref:o.afterButtonSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:X}))}let lt="div",ut=te.RenderStrategy|te.Static;function he(e,u){let p=r.useId(),{id:x=`headlessui-popover-backdrop-${p}`,transition:m=!1,...g}=e,[{popoverState:C},o]=ne("Popover.Backdrop"),[f,h]=r.useState(null),n=j(u,h),b=Se(),[d,y]=Ee(m,f,b!==null?(b&q.Open)===q.Open:C===0),$=E(c=>{if($e(c.currentTarget))return c.preventDefault();o({type:1})}),P=r.useMemo(()=>({open:C===0}),[C]),l={ref:n,id:x,"aria-hidden":!0,onClick:$,...ye(y)};return ee()({ourProps:l,theirProps:g,slot:P,defaultTag:lt,features:ut,visible:d,name:"Popover.Backdrop"})}let at="div",st=te.RenderStrategy|te.Static;function it(e,u){let p=r.useId(),{id:x=`headlessui-popover-panel-${p}`,focus:m=!1,anchor:g,portal:C=!1,modal:o=!1,transition:f=!1,...h}=e,[n,b]=ne("Popover.Panel"),{close:d,isPortalled:y}=de("Popover.Panel"),$=`headlessui-focus-sentinel-before-${p}`,P=`headlessui-focus-sentinel-after-${p}`,l=r.useRef(null),c=ke(g),[S,B]=Be(c),R=Re();c&&(C=!0);let[M,Q]=r.useState(null),O=j(l,u,c?S:null,E(t=>b({type:4,panel:t})),Q),w=ie(l);_e(()=>(b({type:5,panelId:x}),()=>{b({type:5,panelId:null})}),[x,b]);let K=Se(),[T,Y]=Ee(f,M,K!==null?(K&q.Open)===q.Open:n.popoverState===0);Ae(T,n.button,()=>{b({type:1})});let G=n.__demoMode?!1:o&&T;Ke(G,w);let _=E(t=>{var i;switch(t.key){case H.Escape:if(n.popoverState!==0||!l.current||w!=null&&w.activeElement&&!l.current.contains(w.activeElement))return;t.preventDefault(),t.stopPropagation(),b({type:1}),(i=n.button)==null||i.focus();break}});r.useEffect(()=>{var t;e.static||n.popoverState===1&&((t=e.unmount)==null||t)&&b({type:4,panel:null})},[n.popoverState,e.unmount,e.static,b]),r.useEffect(()=>{if(n.__demoMode||!m||n.popoverState!==0||!l.current)return;let t=w==null?void 0:w.activeElement;l.current.contains(t)||U(l.current,A.First)},[n.__demoMode,m,l.current,n.popoverState]);let D=r.useMemo(()=>({open:n.popoverState===0,close:d}),[n.popoverState,d]),Z=le(c?R():{},{ref:O,id:x,onKeyDown:_,onBlur:m&&n.popoverState===0?t=>{var i,s,F,k,I;let N=t.relatedTarget;N&&l.current&&((i=l.current)!=null&&i.contains(N)||(b({type:1}),((F=(s=n.beforePanelSentinel.current)==null?void 0:s.contains)!=null&&F.call(s,N)||(I=(k=n.afterPanelSentinel.current)==null?void 0:k.contains)!=null&&I.call(k,N))&&N.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...h.style,...B,"--button-width":Me(n.button,!0).width},...ye(Y)}),V=Pe(),W=E(()=>{let t=l.current;if(!t)return;function i(){J(V.current,{[L.Forwards]:()=>{var s;U(t,A.First)===se.Error&&((s=n.afterPanelSentinel.current)==null||s.focus())},[L.Backwards]:()=>{var s;(s=n.button)==null||s.focus({preventScroll:!0})}})}i()}),X=E(()=>{let t=l.current;if(!t)return;function i(){J(V.current,{[L.Forwards]:()=>{if(!n.button)return;let s=ce(),F=s.indexOf(n.button),k=s.slice(0,F+1),I=[...s.slice(F+1),...k];for(let N of I.slice())if(N.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(N)){let ve=I.indexOf(N);ve!==-1&&I.splice(ve,1)}U(I,A.First,{sorted:!1})},[L.Backwards]:()=>{var s;U(t,A.Previous)===se.Error&&((s=n.button)==null||s.focus())}})}i()}),a=ee();return v.createElement(Qe,null,v.createElement(oe.Provider,{value:x},v.createElement(re.Provider,{value:{close:d,isPortalled:y}},v.createElement(Ge,{enabled:C?e.static||T:!1},T&&y&&v.createElement(ue,{id:$,ref:n.beforePanelSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:W}),a({ourProps:Z,theirProps:h,slot:D,defaultTag:at,features:st,visible:T,name:"Popover.Panel"}),T&&y&&v.createElement(ue,{id:P,ref:n.afterPanelSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:X})))))}let ct="div";function pt(e,u){let p=r.useRef(null),x=j(p,u),[m,g]=r.useState([]),C=E(P=>{g(l=>{let c=l.indexOf(P);if(c!==-1){let S=l.slice();return S.splice(c,1),S}return l})}),o=E(P=>(g(l=>[...l,P]),()=>C(P))),f=E(()=>{var P;let l=We(p);if(!l)return!1;let c=l.activeElement;return(P=p.current)!=null&&P.contains(c)?!0:m.some(S=>{var B,R;return((B=l.getElementById(S.buttonId.current))==null?void 0:B.contains(c))||((R=l.getElementById(S.panelId.current))==null?void 0:R.contains(c))})}),h=E(P=>{for(let l of m)l.buttonId.current!==P&&l.close()}),n=r.useMemo(()=>({registerPopover:o,unregisterPopover:C,isFocusWithinPopoverGroup:f,closeOthers:h}),[o,C,f,h]),b=r.useMemo(()=>({}),[]),d=e,y={ref:x},$=ee();return v.createElement(be,null,v.createElement(fe.Provider,{value:n},$({ourProps:y,theirProps:d,slot:b,defaultTag:ct,name:"Popover.Group"})))}let dt=z(nt),ft=z(ot),vt=z(he),mt=z(he),bt=z(it),Pt=z(pt),Bt=Object.assign(dt,{Button:ft,Backdrop:mt,Overlay:vt,Panel:bt,Group:Pt});export{mt as C,bt as R,ft as S,Bt as l};
