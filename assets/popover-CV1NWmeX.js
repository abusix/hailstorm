import{$ as Ie,a as he,w as Te,T as Fe}from"./use-resolve-button-type-BHGf7naR.js";import{r as o,R as m}from"./index-0d5eMwbi.js";import{v as xe,y as Be,x as Ce,R as we,b as Me,f as ke}from"./floating-Bz93zg6s.js";import{M as X,W as q,y as Z,T as Re,s as ve,o as h,u as j,H as z,D as oe,I as Oe,n as _e}from"./use-sync-refs-Belg-Qp7.js";import{E as De}from"./use-event-listener-C9n0Ce48.js";import{m as Ne}from"./use-server-handoff-complete-CBlwwdlU.js";import{n as se,e as Ge,F as Le,f as He,t as Ae}from"./portal-C3yob4jK.js";import{b as Ve,R as je,O as me,u as be,a as D}from"./use-tab-direction-B-d4Y1RY.js";import{c as Ke,i as Q,u as Pe,V as $e,A as Se,s as Ue}from"./open-closed-DLjF8coL.js";import{u as Je}from"./close-provider-KddA2ISG.js";import{T as le,s as ae}from"./hidden-DwjBRFc3.js";import{r as Ee}from"./bugs-DpEN4NTH.js";import{b as ie,P as V,F as N,A as We,h as Ze,T as ue}from"./focus-management-Da9hupaT.js";import{o as A,u as Qe}from"./keyboard-BjoLB3hk.js";var qe=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(qe||{}),Ye=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ye||{});let ze={0:e=>({...e,popoverState:j(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,l){return e.button===l.button?e:{...e,button:l.button}},3(e,l){return e.buttonId===l.buttonId?e:{...e,buttonId:l.buttonId}},4(e,l){return e.panel===l.panel?e:{...e,panel:l.panel}},5(e,l){return e.panelId===l.panelId?e:{...e,panelId:l.panelId}}},pe=o.createContext(null);pe.displayName="PopoverContext";function ee(e){let l=o.useContext(pe);if(l===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,ee),c}return l}let te=o.createContext(null);te.displayName="PopoverAPIContext";function ce(e){let l=o.useContext(te);if(l===null){let c=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,ce),c}return l}let de=o.createContext(null);de.displayName="PopoverGroupContext";function ye(){return o.useContext(de)}let ne=o.createContext(null);ne.displayName="PopoverPanelContext";function Xe(){return o.useContext(ne)}function et(e,l){return j(l.type,ze,e,l)}let tt="div";function nt(e,l){var c;let{__demoMode:T=!1,...b}=e,y=o.useRef(null),F=Z(l,Re(n=>{y.current=n})),a=o.useRef([]),d=o.useReducer(et,{__demoMode:T,popoverState:T?0:1,buttons:a,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:o.createRef(),afterPanelSentinel:o.createRef(),afterButtonSentinel:o.createRef()}),[{popoverState:g,button:t,buttonId:S,panel:f,panelId:E,beforePanelSentinel:i,afterPanelSentinel:p,afterButtonSentinel:s},P]=d,I=se((c=y.current)!=null?c:t),w=o.useMemo(()=>{if(!t||!f)return!1;for(let $ of document.querySelectorAll("body > *"))if(Number($==null?void 0:$.contains(t))^Number($==null?void 0:$.contains(f)))return!0;let n=ie(),r=n.indexOf(t),u=(r+n.length-1)%n.length,v=(r+1)%n.length,x=n[u],M=n[v];return!f.contains(x)&&!f.contains(M)},[t,f]),K=ve(S),G=ve(E),B=o.useMemo(()=>({buttonId:K,panelId:G,close:()=>P({type:1})}),[K,G,P]),k=ye(),R=k==null?void 0:k.registerPopover,C=h(()=>{var n;return(n=k==null?void 0:k.isFocusWithinPopoverGroup())!=null?n:(I==null?void 0:I.activeElement)&&((t==null?void 0:t.contains(I.activeElement))||(f==null?void 0:f.contains(I.activeElement)))});o.useEffect(()=>R==null?void 0:R(B),[R,B]);let[U,J]=Ge(),L=Ve(t),O=je({mainTreeNode:L,portals:U,defaultContainers:[t,f]});De(I==null?void 0:I.defaultView,"focus",n=>{var r,u,v,x,M,$;n.target!==window&&n.target instanceof HTMLElement&&g===0&&(C()||t&&f&&(O.contains(n.target)||(u=(r=i.current)==null?void 0:r.contains)!=null&&u.call(r,n.target)||(x=(v=p.current)==null?void 0:v.contains)!=null&&x.call(v,n.target)||($=(M=s.current)==null?void 0:M.contains)!=null&&$.call(M,n.target)||P({type:1})))},!0),Le(g===0,O.resolveContainers,(n,r)=>{P({type:1}),We(r,Ze.Loose)||(n.preventDefault(),t==null||t.focus())});let _=h(n=>{P({type:1});let r=n?n instanceof HTMLElement?n:"current"in n&&n.current instanceof HTMLElement?n.current:t:t;r==null||r.focus()}),H=o.useMemo(()=>({close:_,isPortalled:w}),[_,w]),Y=o.useMemo(()=>({open:g===0,close:_}),[g,_]),W={ref:F};return m.createElement(me,{node:L},m.createElement(xe,null,m.createElement(ne.Provider,{value:null},m.createElement(pe.Provider,{value:d},m.createElement(te.Provider,{value:H},m.createElement(Je,{value:_},m.createElement(Ke,{value:j(g,{0:Q.Open,1:Q.Closed})},m.createElement(J,null,z({ourProps:W,theirProps:b,slot:Y,defaultTag:tt,name:"Popover"})))))))))}let rt="button";function ot(e,l){let c=o.useId(),{id:T=`headlessui-popover-button-${c}`,disabled:b=!1,autoFocus:y=!1,...F}=e,[a,d]=ee("Popover.Button"),{isPortalled:g}=ce("Popover.Button"),t=o.useRef(null),S=`headlessui-focus-sentinel-${o.useId()}`,f=ye(),E=f==null?void 0:f.closeOthers,i=Xe()!==null;o.useEffect(()=>{if(!i)return d({type:3,buttonId:T}),()=>{d({type:3,buttonId:null})}},[i,T,d]);let[p]=o.useState(()=>Symbol()),s=Z(t,l,Be(),i?null:r=>{if(r)a.buttons.current.push(p);else{let u=a.buttons.current.indexOf(p);u!==-1&&a.buttons.current.splice(u,1)}a.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),r&&d({type:2,button:r})}),P=Z(t,l),I=se(t),w=h(r=>{var u,v,x;if(i){if(a.popoverState===1)return;switch(r.key){case A.Space:case A.Enter:r.preventDefault(),(v=(u=r.target).click)==null||v.call(u),d({type:1}),(x=a.button)==null||x.focus();break}}else switch(r.key){case A.Space:case A.Enter:r.preventDefault(),r.stopPropagation(),a.popoverState===1&&(E==null||E(a.buttonId)),d({type:0});break;case A.Escape:if(a.popoverState!==0)return E==null?void 0:E(a.buttonId);if(!t.current||I!=null&&I.activeElement&&!t.current.contains(I.activeElement))return;r.preventDefault(),r.stopPropagation(),d({type:1});break}}),K=h(r=>{i||r.key===A.Space&&r.preventDefault()}),G=h(r=>{var u,v;Ee(r.currentTarget)||b||(i?(d({type:1}),(u=a.button)==null||u.focus()):(r.preventDefault(),r.stopPropagation(),a.popoverState===1&&(E==null||E(a.buttonId)),d({type:0}),(v=a.button)==null||v.focus()))}),B=h(r=>{r.preventDefault(),r.stopPropagation()}),{isFocusVisible:k,focusProps:R}=Ie({autoFocus:y}),{isHovered:C,hoverProps:U}=he({isDisabled:b}),{pressed:J,pressProps:L}=Te({disabled:b}),O=a.popoverState===0,_=o.useMemo(()=>({open:O,active:J||O,disabled:b,hover:C,focus:k,autofocus:y}),[O,C,k,J,b,y]),H=Fe(e,t),Y=i?oe({ref:P,type:H,onKeyDown:w,onClick:G,disabled:b||void 0,autoFocus:y},R,U,L):oe({ref:s,id:a.buttonId,type:H,"aria-expanded":a.popoverState===0,"aria-controls":a.panel?a.panelId:void 0,disabled:b||void 0,autoFocus:y,onKeyDown:w,onKeyUp:K,onClick:G,onMouseDown:B},R,U,L),W=be(),n=h(()=>{let r=a.panel;if(!r)return;function u(){j(W.current,{[D.Forwards]:()=>V(r,N.First),[D.Backwards]:()=>V(r,N.Last)})===ue.Error&&V(ie().filter(v=>v.dataset.headlessuiFocusGuard!=="true"),j(W.current,{[D.Forwards]:N.Next,[D.Backwards]:N.Previous}),{relativeTo:a.button})}u()});return m.createElement(m.Fragment,null,z({ourProps:Y,theirProps:F,slot:_,defaultTag:rt,name:"Popover.Button"}),O&&!i&&g&&m.createElement(le,{id:S,ref:a.afterButtonSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:n}))}let lt="div",at=X.RenderStrategy|X.Static;function ge(e,l){let c=o.useId(),{id:T=`headlessui-popover-backdrop-${c}`,transition:b=!1,...y}=e,[{popoverState:F},a]=ee("Popover.Backdrop"),d=o.useRef(null),g=Z(l,d),t=Pe(),[S,f]=$e(b,d,t!==null?(t&Q.Open)===Q.Open:F===0),E=h(s=>{if(Ee(s.currentTarget))return s.preventDefault();a({type:1})}),i=o.useMemo(()=>({open:F===0}),[F]),p={ref:g,id:T,"aria-hidden":!0,onClick:E,...Se(f)};return z({ourProps:p,theirProps:y,slot:i,defaultTag:lt,features:at,visible:S,name:"Popover.Backdrop"})}let ut="div",st=X.RenderStrategy|X.Static;function it(e,l){let c=o.useId(),{id:T=`headlessui-popover-panel-${c}`,focus:b=!1,anchor:y,portal:F=!1,modal:a=!1,transition:d=!1,...g}=e,[t,S]=ee("Popover.Panel"),{close:f,isPortalled:E}=ce("Popover.Panel"),i=`headlessui-focus-sentinel-before-${c}`,p=`headlessui-focus-sentinel-after-${c}`,s=o.useRef(null),P=Ce(y),[I,w]=we(P),K=Me();P&&(F=!0);let G=Z(s,l,P?I:null,n=>{S({type:4,panel:n})}),B=se(s),k=Oe();_e(()=>(S({type:5,panelId:T}),()=>{S({type:5,panelId:null})}),[T,S]);let R=Pe(),[C,U]=$e(d,s,R!==null?(R&Q.Open)===Q.Open:t.popoverState===0);Ne(C,t.button,()=>{S({type:1})});let J=t.__demoMode?!1:a&&C;He(J,B);let L=h(n=>{var r;switch(n.key){case A.Escape:if(t.popoverState!==0||!s.current||B!=null&&B.activeElement&&!s.current.contains(B.activeElement))return;n.preventDefault(),n.stopPropagation(),S({type:1}),(r=t.button)==null||r.focus();break}});o.useEffect(()=>{var n;e.static||t.popoverState===1&&((n=e.unmount)==null||n)&&S({type:4,panel:null})},[t.popoverState,e.unmount,e.static,S]),o.useEffect(()=>{if(t.__demoMode||!b||t.popoverState!==0||!s.current)return;let n=B==null?void 0:B.activeElement;s.current.contains(n)||V(s.current,N.First)},[t.__demoMode,b,s.current,t.popoverState]);let O=o.useMemo(()=>({open:t.popoverState===0,close:f}),[t.popoverState,f]),_=oe(P?K():{},{ref:G,id:T,onKeyDown:L,onBlur:b&&t.popoverState===0?n=>{var r,u,v,x,M;let $=n.relatedTarget;$&&s.current&&((r=s.current)!=null&&r.contains($)||(S({type:1}),((v=(u=t.beforePanelSentinel.current)==null?void 0:u.contains)!=null&&v.call(u,$)||(M=(x=t.afterPanelSentinel.current)==null?void 0:x.contains)!=null&&M.call(x,$))&&$.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...g.style,...w,"--button-width":ke(t.button,!0).width},...Se(U)}),H=be(),Y=h(()=>{let n=s.current;if(!n)return;function r(){j(H.current,{[D.Forwards]:()=>{var u;V(n,N.First)===ue.Error&&((u=t.afterPanelSentinel.current)==null||u.focus())},[D.Backwards]:()=>{var u;(u=t.button)==null||u.focus({preventScroll:!0})}})}r()}),W=h(()=>{let n=s.current;if(!n)return;function r(){j(H.current,{[D.Forwards]:()=>{var u;if(!t.button)return;let v=ie(),x=v.indexOf(t.button),M=v.slice(0,x+1),$=[...v.slice(x+1),...M];for(let re of $.slice())if(re.dataset.headlessuiFocusGuard==="true"||(u=t.panel)!=null&&u.contains(re)){let fe=$.indexOf(re);fe!==-1&&$.splice(fe,1)}V($,N.First,{sorted:!1})},[D.Backwards]:()=>{var u;V(n,N.Previous)===ue.Error&&((u=t.button)==null||u.focus())}})}r()});return m.createElement(Ue,null,m.createElement(ne.Provider,{value:T},m.createElement(te.Provider,{value:{close:f,isPortalled:E}},m.createElement(Ae,{enabled:F?e.static||C:!1},C&&E&&m.createElement(le,{id:i,ref:t.beforePanelSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Y}),z({mergeRefs:k,ourProps:_,theirProps:g,slot:O,defaultTag:ut,features:st,visible:C,name:"Popover.Panel"}),C&&E&&m.createElement(le,{id:p,ref:t.afterPanelSentinel,features:ae.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:W})))))}let pt="div";function ct(e,l){let c=o.useRef(null),T=Z(c,l),[b,y]=o.useState([]),F=h(i=>{y(p=>{let s=p.indexOf(i);if(s!==-1){let P=p.slice();return P.splice(s,1),P}return p})}),a=h(i=>(y(p=>[...p,i]),()=>F(i))),d=h(()=>{var i;let p=Qe(c);if(!p)return!1;let s=p.activeElement;return(i=c.current)!=null&&i.contains(s)?!0:b.some(P=>{var I,w;return((I=p.getElementById(P.buttonId.current))==null?void 0:I.contains(s))||((w=p.getElementById(P.panelId.current))==null?void 0:w.contains(s))})}),g=h(i=>{for(let p of b)p.buttonId.current!==i&&p.close()}),t=o.useMemo(()=>({registerPopover:a,unregisterPopover:F,isFocusWithinPopoverGroup:d,closeOthers:g}),[a,F,d,g]),S=o.useMemo(()=>({}),[]),f=e,E={ref:T};return m.createElement(me,null,m.createElement(de.Provider,{value:t},z({ourProps:E,theirProps:f,slot:S,defaultTag:pt,name:"Popover.Group"})))}let dt=q(nt),ft=q(ot),vt=q(ge),mt=q(ge),bt=q(it),Pt=q(ct),kt=Object.assign(dt,{Button:ft,Backdrop:mt,Overlay:vt,Panel:bt,Group:Pt});export{bt as B,mt as C,ft as S,kt as l};
