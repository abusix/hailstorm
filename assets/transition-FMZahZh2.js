import{r as a,R as E}from"./index-OjgoNOWw.js";import{u as w,b as D,l as I,S as ve,D as Q,y as ee,j as x,a as re,o as C,t as Y,X as te}from"./render--CnTCjM4.js";import{c as pe,d as F,C as ne}from"./open-closed-QZcf9p9x.js";import{f as ie}from"./use-is-mounted-sHLtXe0b.js";import{o as W}from"./disposables-x8EK1kJp.js";import{p as le}from"./use-disposables-zYA53INM.js";import{c as he}from"./use-flags-FD8DIccc.js";function be(r){let e={called:!1};return(...t)=>{if(!e.called)return e.called=!0,r(...t)}}function z(r,...e){r&&e.length>0&&r.classList.add(...e)}function G(r,...e){r&&e.length>0&&r.classList.remove(...e)}function ge(r,e){let t=W();if(!r)return t.dispose;let{transitionDuration:l,transitionDelay:m}=getComputedStyle(r),[h,v]=[l,m].map(u=>{let[i=0]=u.split(",").filter(Boolean).map(o=>o.includes("ms")?parseFloat(o):parseFloat(o)*1e3).sort((o,b)=>b-o);return i}),d=h+v;if(d!==0){t.group(i=>{i.setTimeout(()=>{e(),i.dispose()},d),i.addEventListener(r,"transitionrun",o=>{o.target===o.currentTarget&&i.dispose()})});let u=t.addEventListener(r,"transitionend",i=>{i.target===i.currentTarget&&(e(),u())})}else e();return t.add(()=>e()),t.dispose}function Ee(r,e,t,l){let m=t?"enter":"leave",h=W(),v=l!==void 0?be(l):()=>{};m==="enter"&&(r.removeAttribute("hidden"),r.style.display="");let d=w(m,{enter:()=>e.enter,leave:()=>e.leave}),u=w(m,{enter:()=>e.enterTo,leave:()=>e.leaveTo}),i=w(m,{enter:()=>e.enterFrom,leave:()=>e.leaveFrom});return G(r,...e.base,...e.enter,...e.enterTo,...e.enterFrom,...e.leave,...e.leaveFrom,...e.leaveTo,...e.entered),z(r,...e.base,...d,...i),h.nextFrame(()=>{G(r,...e.base,...d,...i),z(r,...e.base,...d,...u),ge(r,()=>(G(r,...e.base,...d),z(r,...e.base,...e.entered),v()))}),h.dispose}function Te({immediate:r,container:e,direction:t,classes:l,onStart:m,onStop:h}){let v=ie(),d=le(),u=D(t);I(()=>{r&&(u.current="enter")},[r]),I(()=>{let i=W();d.add(i.dispose);let o=e.current;if(o&&u.current!=="idle"&&v.current)return i.dispose(),m.current(u.current),i.add(Ee(o,l.current,u.current==="enter",()=>{i.dispose(),h.current(u.current)})),i.dispose},[t])}function $(r=""){return r.split(" ").filter(e=>e.trim().length>1)}let U=a.createContext(null);U.displayName="TransitionContext";var $e=(r=>(r.Visible="visible",r.Hidden="hidden",r))($e||{});function Fe(){let r=a.useContext(U);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}function we(){let r=a.useContext(j);if(r===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return r}let j=a.createContext(null);j.displayName="NestingContext";function k(r){return"children"in r?k(r.children):r.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function ae(r,e){let t=D(r),l=a.useRef([]),m=ie(),h=le(),v=C((f,s=x.Hidden)=>{let c=l.current.findIndex(({el:n})=>n===f);c!==-1&&(w(s,{[x.Unmount](){l.current.splice(c,1)},[x.Hidden](){l.current[c].state="hidden"}}),h.microTask(()=>{var n;!k(l)&&m.current&&((n=t.current)==null||n.call(t))}))}),d=C(f=>{let s=l.current.find(({el:c})=>c===f);return s?s.state!=="visible"&&(s.state="visible"):l.current.push({el:f,state:"visible"}),()=>v(f,x.Unmount)}),u=a.useRef([]),i=a.useRef(Promise.resolve()),o=a.useRef({enter:[],leave:[],idle:[]}),b=C((f,s,c)=>{u.current.splice(0),e&&(e.chains.current[s]=e.chains.current[s].filter(([n])=>n!==f)),e==null||e.chains.current[s].push([f,new Promise(n=>{u.current.push(n)})]),e==null||e.chains.current[s].push([f,new Promise(n=>{Promise.all(o.current[s].map(([L,P])=>P)).then(()=>n())})]),s==="enter"?i.current=i.current.then(()=>e==null?void 0:e.wait.current).then(()=>c(s)):c(s)}),g=C((f,s,c)=>{Promise.all(o.current[s].splice(0).map(([n,L])=>L)).then(()=>{var n;(n=u.current.shift())==null||n()}).then(()=>c(s))});return a.useMemo(()=>({children:l,register:d,unregister:v,onStart:b,onStop:g,wait:i,chains:o}),[d,v,l,b,g,o,i])}function Ce(){}let Re=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Z(r){var e;let t={};for(let l of Re)t[l]=(e=r[l])!=null?e:Ce;return t}function Se(r){let e=a.useRef(Z(r));return a.useEffect(()=>{e.current=Z(r)},[r]),e}let xe="div",se=ve.RenderStrategy;function Le(r,e){var t,l;let{beforeEnter:m,afterEnter:h,beforeLeave:v,afterLeave:d,enter:u,enterFrom:i,enterTo:o,entered:b,leave:g,leaveFrom:f,leaveTo:s,...c}=r,n=a.useRef(null),L=ee(n,e),P=(t=c.unmount)==null||t?x.Unmount:x.Hidden,{show:p,appear:R,initial:X}=Fe(),[S,B]=a.useState(p?"visible":"hidden"),_=we(),{register:O,unregister:H}=_;a.useEffect(()=>O(n),[O,n]),a.useEffect(()=>{if(P===x.Hidden&&n.current){if(p&&S!=="visible"){B("visible");return}return w(S,{hidden:()=>H(n),visible:()=>O(n)})}},[S,n,O,H,p,P]);let V=D({base:$(c.className),enter:$(u),enterFrom:$(i),enterTo:$(o),entered:$(b),leave:$(g),leaveFrom:$(f),leaveTo:$(s)}),A=Se({beforeEnter:m,afterEnter:h,beforeLeave:v,afterLeave:d}),q=re();a.useEffect(()=>{if(q&&S==="visible"&&n.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[n,S,q]);let ue=X&&!R,J=R&&p&&X,ce=!q||ue?"idle":p?"enter":"leave",N=he(0),de=C(T=>w(T,{enter:()=>{N.addFlag(F.Opening),A.current.beforeEnter()},leave:()=>{N.addFlag(F.Closing),A.current.beforeLeave()},idle:()=>{}})),fe=C(T=>w(T,{enter:()=>{N.removeFlag(F.Opening),A.current.afterEnter()},leave:()=>{N.removeFlag(F.Closing),A.current.afterLeave()},idle:()=>{}})),M=ae(()=>{B("hidden"),H(n)},_);Te({immediate:J,container:n,classes:V,direction:ce,onStart:D(T=>{M.onStart(n,T,de)}),onStop:D(T=>{M.onStop(n,T,fe),T==="leave"&&!k(M)&&(B("hidden"),H(n))})});let y=c,me={ref:L};return J?y={...y,className:Y(c.className,...V.current.enter,...V.current.enterFrom)}:(y.className=Y(c.className,(l=n.current)==null?void 0:l.className),y.className===""&&delete y.className),E.createElement(j.Provider,{value:M},E.createElement(pe,{value:w(S,{visible:F.Open,hidden:F.Closed})|N.flags},te({ourProps:me,theirProps:y,defaultTag:xe,features:se,visible:S==="visible",name:"Transition.Child"})))}function Pe(r,e){let{show:t,appear:l=!1,unmount:m=!0,...h}=r,v=a.useRef(null),d=ee(v,e);re();let u=ne();if(t===void 0&&u!==null&&(t=(u&F.Open)===F.Open),![!0,!1].includes(t))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[i,o]=a.useState(t?"visible":"hidden"),b=ae(()=>{o("hidden")}),[g,f]=a.useState(!0),s=a.useRef([t]);I(()=>{g!==!1&&s.current[s.current.length-1]!==t&&(s.current.push(t),f(!1))},[s,t]);let c=a.useMemo(()=>({show:t,appear:l,initial:g}),[t,l,g]);a.useEffect(()=>{if(t)o("visible");else if(!k(b))o("hidden");else{let p=v.current;if(!p)return;let R=p.getBoundingClientRect();R.x===0&&R.y===0&&R.width===0&&R.height===0&&o("hidden")}},[t,b]);let n={unmount:m},L=C(()=>{var p;g&&f(!1),(p=r.beforeEnter)==null||p.call(r)}),P=C(()=>{var p;g&&f(!1),(p=r.beforeLeave)==null||p.call(r)});return E.createElement(j.Provider,{value:b},E.createElement(U.Provider,{value:c},te({ourProps:{...n,as:a.Fragment,children:E.createElement(oe,{ref:d,...n,...h,beforeEnter:L,beforeLeave:P})},theirProps:{},defaultTag:a.Fragment,features:se,visible:i==="visible",name:"Transition"})))}function ye(r,e){let t=a.useContext(U)!==null,l=ne()!==null;return E.createElement(E.Fragment,null,!t&&l?E.createElement(K,{ref:e,...r}):E.createElement(oe,{ref:e,...r}))}let K=Q(Pe),oe=Q(Le),Ne=Q(ye),ke=Object.assign(K,{Child:Ne,Root:K});export{ke as t};
