import{$ as xe,a as we,w as Ce,e as Be}from"./use-resolve-button-type-anS-OQ-j.js";import{r as n,R as m}from"./index-DRjF_FHU.js";import{M as Fe,x as Te,R as ke,b as Re,d as Me,y as Oe}from"./floating-B5xy_Q8r.js";import{K as z,y as j,T as _e,s as be,o as y,L as te,u as X,n as De,_ as ue,O as re}from"./use-sync-refs-4PSbzubZ.js";import{E as Ae}from"./use-event-listener-BepRZUYA.js";import{n as ne,l as Le,R as Ne,m as Ge,f as Ke,o as Ve}from"./portal-Cg6DHy_v.js";import{b as qe,R as He,O as Pe,u as $e,a as N}from"./use-tab-direction-CxSovYzz.js";import{c as Ue,u as Se,x as ye,i as Y,R as Ee,s as Je}from"./open-closed-yLnem6BE.js";import{C as Xe}from"./close-provider-CMV4gi-l.js";import{f as se,s as ie}from"./hidden-BTT1K2UY.js";import{r as ge}from"./bugs-DpEN4NTH.js";import{b as pe,P as J,F as G,T as ce,A as We,h as Ze}from"./focus-management-CtIqEZ7d.js";import{o as je,a as U}from"./keyboard-BXsyG9-6.js";var Ye=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ye||{}),ze=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(ze||{});let Qe={0:e=>({...e,popoverState:X(e.popoverState,{0:1,1:0}),__demoMode:!1}),1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,u){return e.button===u.button?e:{...e,button:u.button}},3(e,u){return e.buttonId===u.buttonId?e:{...e,buttonId:u.buttonId}},4(e,u){return e.panel===u.panel?e:{...e,panel:u.panel}},5(e,u){return e.panelId===u.panelId?e:{...e,panelId:u.panelId}}},de=n.createContext(null);de.displayName="PopoverContext";function oe(e){let u=n.useContext(de);if(u===null){let d=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,oe),d}return u}let le=n.createContext(null);le.displayName="PopoverAPIContext";function fe(e){let u=n.useContext(le);if(u===null){let d=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,fe),d}return u}let ve=n.createContext(null);ve.displayName="PopoverGroupContext";function he(){return n.useContext(ve)}let ae=n.createContext(null);ae.displayName="PopoverPanelContext";function et(){return n.useContext(ae)}function tt(e,u){return X(u.type,Qe,e,u)}let rt="div";function nt(e,u){var d;let{__demoMode:x=!1,...b}=e,h=n.useRef(null),w=j(u,_e(s=>{h.current=s})),l=n.useRef([]),v=n.useReducer(tt,{__demoMode:x,popoverState:x?0:1,buttons:l,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:n.createRef(),afterPanelSentinel:n.createRef(),afterButtonSentinel:n.createRef()}),[{popoverState:I,button:t,buttonId:P,panel:f,panelId:E,beforePanelSentinel:g,afterPanelSentinel:$,afterButtonSentinel:a},p]=v,S=ne((d=h.current)!=null?d:t),k=n.useMemo(()=>{if(!t||!f)return!1;for(let C of document.querySelectorAll("body > *"))if(Number(C==null?void 0:C.contains(t))^Number(C==null?void 0:C.contains(f)))return!0;let s=pe(),r=s.indexOf(t),o=(r+s.length-1)%s.length,c=(r+1)%s.length,i=s[o],T=s[c];return!f.contains(i)&&!f.contains(T)},[t,f]),R=be(P),M=be(E),W=n.useMemo(()=>({buttonId:R,panelId:M,close:()=>p({type:1})}),[R,M,p]),O=he(),L=O==null?void 0:O.registerPopover,B=y(()=>{var s;return(s=O==null?void 0:O.isFocusWithinPopoverGroup())!=null?s:(S==null?void 0:S.activeElement)&&((t==null?void 0:t.contains(S.activeElement))||(f==null?void 0:f.contains(S.activeElement)))});n.useEffect(()=>L==null?void 0:L(W),[L,W]);let[K,F]=Le(),V=qe(t),_=He({mainTreeNode:V,portals:K,defaultContainers:[t,f]});Ae(S==null?void 0:S.defaultView,"focus",s=>{var r,o,c,i,T,C;s.target!==window&&s.target instanceof HTMLElement&&I===0&&(B()||t&&f&&(_.contains(s.target)||(o=(r=g.current)==null?void 0:r.contains)!=null&&o.call(r,s.target)||(i=(c=$.current)==null?void 0:c.contains)!=null&&i.call(c,s.target)||(C=(T=a.current)==null?void 0:T.contains)!=null&&C.call(T,s.target)||p({type:1})))},!0),Ne(I===0,_.resolveContainers,(s,r)=>{p({type:1}),We(r,Ze.Loose)||(s.preventDefault(),t==null||t.focus())});let D=y(s=>{p({type:1});let r=s?s instanceof HTMLElement?s:"current"in s&&s.current instanceof HTMLElement?s.current:t:t;r==null||r.focus()}),Z=n.useMemo(()=>({close:D,isPortalled:k}),[D,k]),Q=n.useMemo(()=>({open:I===0,close:D}),[I,D]),q={ref:w},ee=te();return m.createElement(Pe,{node:V},m.createElement(Fe,null,m.createElement(ae.Provider,{value:null},m.createElement(de.Provider,{value:v},m.createElement(le.Provider,{value:Z},m.createElement(Xe,{value:D},m.createElement(Ue,{value:X(I,{0:Y.Open,1:Y.Closed})},m.createElement(F,null,ee({ourProps:q,theirProps:b,slot:Q,defaultTag:rt,name:"Popover"})))))))))}let ot="button";function lt(e,u){let d=n.useId(),{id:x=`headlessui-popover-button-${d}`,disabled:b=!1,autoFocus:h=!1,...w}=e,[l,v]=oe("Popover.Button"),{isPortalled:I}=fe("Popover.Button"),t=n.useRef(null),P=`headlessui-focus-sentinel-${n.useId()}`,f=he(),E=f==null?void 0:f.closeOthers,g=et()!==null;n.useEffect(()=>{if(!g)return v({type:3,buttonId:x}),()=>{v({type:3,buttonId:null})}},[g,x,v]);let[$]=n.useState(()=>Symbol()),a=j(t,u,Oe(),y(r=>{if(!g){if(r)l.buttons.current.push($);else{let o=l.buttons.current.indexOf($);o!==-1&&l.buttons.current.splice(o,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),r&&v({type:2,button:r})}})),p=j(t,u),S=ne(t),k=y(r=>{var o,c,i;if(g){if(l.popoverState===1)return;switch(r.key){case U.Space:case U.Enter:r.preventDefault(),(c=(o=r.target).click)==null||c.call(o),v({type:1}),(i=l.button)==null||i.focus();break}}else switch(r.key){case U.Space:case U.Enter:r.preventDefault(),r.stopPropagation(),l.popoverState===1&&(E==null||E(l.buttonId)),v({type:0});break;case U.Escape:if(l.popoverState!==0)return E==null?void 0:E(l.buttonId);if(!t.current||S!=null&&S.activeElement&&!t.current.contains(S.activeElement))return;r.preventDefault(),r.stopPropagation(),v({type:1});break}}),R=y(r=>{g||r.key===U.Space&&r.preventDefault()}),M=y(r=>{var o,c;ge(r.currentTarget)||b||(g?(v({type:1}),(o=l.button)==null||o.focus()):(r.preventDefault(),r.stopPropagation(),l.popoverState===1&&(E==null||E(l.buttonId)),v({type:0}),(c=l.button)==null||c.focus()))}),W=y(r=>{r.preventDefault(),r.stopPropagation()}),{isFocusVisible:O,focusProps:L}=xe({autoFocus:h}),{isHovered:B,hoverProps:K}=we({isDisabled:b}),{pressed:F,pressProps:V}=Ce({disabled:b}),_=l.popoverState===0,D=n.useMemo(()=>({open:_,active:F||_,disabled:b,hover:B,focus:O,autofocus:h}),[_,B,O,F,b,h]),Z=Be(e,l.button),Q=g?ue({ref:p,type:Z,onKeyDown:k,onClick:M,disabled:b||void 0,autoFocus:h},L,K,V):ue({ref:a,id:l.buttonId,type:Z,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,disabled:b||void 0,autoFocus:h,onKeyDown:k,onKeyUp:R,onClick:M,onMouseDown:W},L,K,V),q=$e(),ee=y(()=>{let r=l.panel;if(!r)return;function o(){X(q.current,{[N.Forwards]:()=>J(r,G.First),[N.Backwards]:()=>J(r,G.Last)})===ce.Error&&J(pe().filter(c=>c.dataset.headlessuiFocusGuard!=="true"),X(q.current,{[N.Forwards]:G.Next,[N.Backwards]:G.Previous}),{relativeTo:l.button})}o()}),s=te();return m.createElement(m.Fragment,null,s({ourProps:Q,theirProps:w,slot:D,defaultTag:ot,name:"Popover.Button"}),_&&!g&&I&&m.createElement(se,{id:P,ref:l.afterButtonSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:ee}))}let at="div",ut=re.RenderStrategy|re.Static;function Ie(e,u){let d=n.useId(),{id:x=`headlessui-popover-backdrop-${d}`,transition:b=!1,...h}=e,[{popoverState:w},l]=oe("Popover.Backdrop"),[v,I]=n.useState(null),t=j(u,I),P=Se(),[f,E]=ye(b,v,P!==null?(P&Y.Open)===Y.Open:w===0),g=y(p=>{if(ge(p.currentTarget))return p.preventDefault();l({type:1})}),$=n.useMemo(()=>({open:w===0}),[w]),a={ref:t,id:x,"aria-hidden":!0,onClick:g,...Ee(E)};return te()({ourProps:a,theirProps:h,slot:$,defaultTag:at,features:ut,visible:f,name:"Popover.Backdrop"})}let st="div",it=re.RenderStrategy|re.Static;function ct(e,u){let d=n.useId(),{id:x=`headlessui-popover-panel-${d}`,focus:b=!1,anchor:h,portal:w=!1,modal:l=!1,transition:v=!1,...I}=e,[t,P]=oe("Popover.Panel"),{close:f,isPortalled:E}=fe("Popover.Panel"),g=`headlessui-focus-sentinel-before-${d}`,$=`headlessui-focus-sentinel-after-${d}`,a=n.useRef(null),p=Te(h),[S,k]=ke(p),R=Re();p&&(w=!0);let[M,W]=n.useState(null),O=j(a,u,p?S:null,y(o=>P({type:4,panel:o})),W),L=ne(t.button),B=ne(a);De(()=>(P({type:5,panelId:x}),()=>{P({type:5,panelId:null})}),[x,P]);let K=Se(),[F,V]=ye(v,M,K!==null?(K&Y.Open)===Y.Open:t.popoverState===0);Ge(F,t.button,()=>{P({type:1})});let _=t.__demoMode?!1:l&&F;Ke(_,B);let D=y(o=>{var c;switch(o.key){case U.Escape:if(t.popoverState!==0||!a.current||B!=null&&B.activeElement&&!a.current.contains(B.activeElement))return;o.preventDefault(),o.stopPropagation(),P({type:1}),(c=t.button)==null||c.focus();break}});n.useEffect(()=>{var o;e.static||t.popoverState===1&&((o=e.unmount)==null||o)&&P({type:4,panel:null})},[t.popoverState,e.unmount,e.static,P]),n.useEffect(()=>{if(t.__demoMode||!b||t.popoverState!==0||!a.current)return;let o=B==null?void 0:B.activeElement;a.current.contains(o)||J(a.current,G.First)},[t.__demoMode,b,a.current,t.popoverState]);let Z=n.useMemo(()=>({open:t.popoverState===0,close:f}),[t.popoverState,f]),Q=ue(p?R():{},{ref:O,id:x,onKeyDown:D,onBlur:b&&t.popoverState===0?o=>{var c,i,T,C,H;let A=o.relatedTarget;A&&a.current&&((c=a.current)!=null&&c.contains(A)||(P({type:1}),((T=(i=t.beforePanelSentinel.current)==null?void 0:i.contains)!=null&&T.call(i,A)||(H=(C=t.afterPanelSentinel.current)==null?void 0:C.contains)!=null&&H.call(C,A))&&A.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...I.style,...k,"--button-width":Me(t.button,!0).width},...Ee(V)}),q=$e(),ee=y(()=>{let o=a.current;if(!o)return;function c(){X(q.current,{[N.Forwards]:()=>{var i;J(o,G.First)===ce.Error&&((i=t.afterPanelSentinel.current)==null||i.focus())},[N.Backwards]:()=>{var i;(i=t.button)==null||i.focus({preventScroll:!0})}})}c()}),s=y(()=>{let o=a.current;if(!o)return;function c(){X(q.current,{[N.Forwards]:()=>{if(!t.button)return;let i=pe(),T=i.indexOf(t.button),C=i.slice(0,T+1),H=[...i.slice(T+1),...C];for(let A of H.slice())if(A.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(A)){let me=H.indexOf(A);me!==-1&&H.splice(me,1)}J(H,G.First,{sorted:!1})},[N.Backwards]:()=>{var i;J(o,G.Previous)===ce.Error&&((i=t.button)==null||i.focus())}})}c()}),r=te();return m.createElement(Je,null,m.createElement(ae.Provider,{value:x},m.createElement(le.Provider,{value:{close:f,isPortalled:E}},m.createElement(Ve,{enabled:w?e.static||F:!1,ownerDocument:L},F&&E&&m.createElement(se,{id:g,ref:t.beforePanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:ee}),r({ourProps:Q,theirProps:I,slot:Z,defaultTag:st,features:it,visible:F,name:"Popover.Panel"}),F&&E&&m.createElement(se,{id:$,ref:t.afterPanelSentinel,features:ie.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:s})))))}let pt="div";function dt(e,u){let d=n.useRef(null),x=j(d,u),[b,h]=n.useState([]),w=y($=>{h(a=>{let p=a.indexOf($);if(p!==-1){let S=a.slice();return S.splice(p,1),S}return a})}),l=y($=>(h(a=>[...a,$]),()=>w($))),v=y(()=>{var $;let a=je(d);if(!a)return!1;let p=a.activeElement;return($=d.current)!=null&&$.contains(p)?!0:b.some(S=>{var k,R;return((k=a.getElementById(S.buttonId.current))==null?void 0:k.contains(p))||((R=a.getElementById(S.panelId.current))==null?void 0:R.contains(p))})}),I=y($=>{for(let a of b)a.buttonId.current!==$&&a.close()}),t=n.useMemo(()=>({registerPopover:l,unregisterPopover:w,isFocusWithinPopoverGroup:v,closeOthers:I}),[l,w,v,I]),P=n.useMemo(()=>({}),[]),f=e,E={ref:x},g=te();return m.createElement(Pe,null,m.createElement(ve.Provider,{value:t},g({ourProps:E,theirProps:f,slot:P,defaultTag:pt,name:"Popover.Group"})))}let ft=z(nt),vt=z(lt),mt=z(Ie),bt=z(Ie),Pt=z(ct),$t=z(dt),Rt=Object.assign(ft,{Button:vt,Backdrop:bt,Overlay:mt,Panel:Pt,Group:$t});export{vt as A,Pt as B,bt as R,Rt as a};
